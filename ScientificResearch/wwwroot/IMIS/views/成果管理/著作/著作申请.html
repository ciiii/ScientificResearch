<script src="/IMIS/js/成果管理/著作/著作申请.js" type="text/javascript"></script>
<div class="modal-content ms-controller add-user" ms-controller="Add">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true" ms-on-click="@clickBtnReturn">&times;</span></button>
        <h4 class="modal-title" id="NoPermissionModalLabel">{{@title}}</h4>
    </div>
    <div class="modal-body">
        <ul class="nav nav-tabs">
            <li role="presentation" class="active">
                <a href="#tab1" aria-controls="tab1" role="tab" data-toggle="tab">著作信息</a>
            </li>
            <li role="presentation">
                <a href="#tab2" aria-controls="tab2" role="tab" data-toggle="tab">相关项目</a>
            </li>
            <li role="presentation">
                <a href="#tab3" aria-controls="tab3" role="tab" data-toggle="tab">作者信息</a>
            </li>
            <li role="presentation">
                <a href="#tab4" aria-controls="tab4" role="tab" data-toggle="tab">相关文件</a>
            </li>
            <li role="presentation" ms-if="@editType">
                <a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab">审核记录</a>
            </li>
        </ul>
        <div class="tab-content">
            <div role="tabpanel" id="tab1" class="tab-pane active">
                <form class="form-horizontal content">
                    <div class="col-sm-12">
                        <h5 class="title"><span>著作信息</span></h5>
                        <div class="form-group col-sm-12">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>著作名称：
                            </label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control paper-name" ms-duplex="@info.基本资料.著作名称" ms-on-change="@inputVal('.paper-name')">
                                <span class="error-texe">著作名称不能为空！</span>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>出版社名称：
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control press-name" ms-duplex="@info.基本资料.出版社名称" ms-on-change="@inputVal('.press-name')">
                                <span class="error-texe">出版社名称不能为空！</span>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">著作形式：</label>
                            <div class="col-sm-7">
                                <label class="radio-inline">
                                    <input type="radio" value="true" name="form" ms-duplex="@info.基本资料.著作形式"> 独著
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" value="false" name="form" ms-duplex="@info.基本资料.著作形式"> 合著
                                </label>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>年度：
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control form-year year" ms-duplex="@info.基本资料.年度"
                                       ms-on-change="@inputVal('.year')">
                                <span class="error-texe">年度不能为空！</span>
                            </div>
                        </div>

                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>出版日期：
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control form-time publish-time" ms-duplex="@info.基本资料.著作出版日期" ms-on-change="@inputVal('.publish-time')">
                                <span class="error-texe">出版日期不能为空！</span>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>ISBN号：
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control form-isbN" ms-duplex="@info.基本资料.isbN" ms-on-change="@inputVal('.form-isbN')">
                                <span class="error-texe">ISBN号不能为空！</span>
                            </div>
                        </div>

                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>著作字数(万字)：
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control work-number"
                                       onkeyup="onlyNum(this)"
                                       ms-duplex="@info.基本资料.著作字数" ms-on-change="@inputVal('.work-number')">
                                <span class="error-texe">著作字数不能为空！</span>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">奖励情况：</label>
                            <div class="col-sm-7">
                                <select class="form-control" ms-duplex="@info.基本资料.奖励情况">
                                    <option value="未奖励">未奖励</option>
                                    <option value="已奖励">已奖励</option>
                                    <option value="不奖励">不奖励</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">出版地：</label>
                            <div class="col-sm-7">
                                <label class="radio-inline">
                                    <input type="radio" value="true" name="publish" ms-duplex="@info.基本资料.出版地"> 国内
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" value="false" name="publish" ms-duplex="@info.基本资料.出版地"> 国外
                                </label>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">出版社级别：</label>
                            <div class="col-sm-7">
                                <select class="form-control column" ms-duplex="@info.基本资料.出版社级别">
                                    <option value="">请选择</option>
                                    <option ms-for="el in @model.出版社级别" ms-attr="{'value':@el}">{{el}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>著作类型：
                            </label>
                            <div class="col-sm-7">
                                <select class="form-control column" ms-duplex="@info.基本资料.著作类型">
                                    <option value="">请选择</option>
                                    <option ms-for="el in @model.著作类型" ms-attr="{'value':@el}">{{el}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">是否译为外文：</label>
                            <div class="col-sm-7">
                                <label class="radio-inline">
                                    <input type="radio" value="true" name="translate" ms-duplex="@info.基本资料.是否译为外文"> 是
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" value="false" name="translate" ms-duplex="@info.基本资料.是否译为外文"> 否
                                </label>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>语种类型：
                            </label>
                            <div class="col-sm-7">
                                <select class="form-control column" ms-duplex="@info.基本资料.语种">
                                    <option value="">请选择</option>
                                    <option ms-for="el in @model.语种类型" ms-attr="{'value':@el}">{{el}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6">
                            <label class="col-sm-3 control-label">学科门类：</label>
                            <div class="col-sm-7">
                                <select class="form-control subjectType" ms-duplex="@info.基本资料.学科门类">
                                    <option value="">请选择</option>
                                    <option ms-for="el in @model.学科门类" ms-attr="{'value':@el}">{{el}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6">
                            <label class="col-sm-3 control-label">一级学科：</label>
                            <div class="col-sm-7">
                                <select class="form-control subjectOne" ms-duplex="oneSelect">
                                    <option value="">请选择</option>
                                    <option ms-for="el in @subjectOne" ms-attr="{'value':@el.编号}">{{el.名称}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6">
                            <label class="col-sm-3 control-label">二级学科：</label>
                            <div class="col-sm-7">
                                <select class="form-control subjectTwo" ms-duplex="twoSelect">
                                    <option ms-if="@subjectTwo.length>0" value="">请选择</option>
                                    <option ms-if="@subjectTwo.length>0" ms-for="el in @subjectTwo"
                                            ms-attr="{'value':@el.编号}">
                                        {{el.名称}}
                                    </option>
                                    <option ms-if="@subjectTwo.length==0" value="">暂无</option>
                                </select>

                            </div>
                        </div>
                        <div class="form-group  col-sm-6">
                            <label class="col-sm-3 control-label">三级学科：</label>
                            <div class="col-sm-7">
                                <select class="form-control subjectThree" ms-duplex="@info.基本资料.三级学科">
                                    <option ms-if="@subjectThree.length>0" value="">请选择</option>
                                    <option ms-if="@subjectThree.length>0" ms-for="el in @subjectThree">{{el.名称}}
                                    </option>

                                    <option ms-if="@subjectThree.length==0" value="">暂无</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">作者人数：</label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control" ms-duplex="@info.基本资料.作者人数">
                            </div>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class="col-sm-3 control-label">发行价(元)：</label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control" onkeyup="onlyNum(this)"
                                       ms-duplex="@info.基本资料.发行价">
                            </div>
                        </div>
                        <div class="form-group col-sm-12">
                            <label class="col-sm-3 control-label">备注：</label>
                            <div class="col-sm-9">
                                <textarea class="form-control" ms-duplex="@info.基本资料.备注" rows="2"></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div role="tabpanel" id="tab2" class="tab-pane">
                <div class="title-box">
                    <a ms-attr="{'href':@getUrl('/IMIS/views/成果管理/论文/选择纵向项目.html')}" class="btn btn-primary btn-add" data-toggle="modal"
                       data-target=".modal-choice" onclick="changeUrlChoice(this,'.modal-choice')">
                        <i class="icon iconfont icon-tianjia"></i> 添加纵向项目
                    </a>
                    <a ms-attr="{'href':@getUrl('/IMIS/views/成果管理/论文/选择横向项目.html')}" class="btn btn-success btn-add" data-toggle="modal"
                       data-target=".modal-choice" onclick="changeUrlChoice(this,'.modal-choice')">
                        <i class="icon iconfont icon-tianjia"></i> 添加横向项目
                    </a>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th width="80">序号</th>
                            <th>项目名称</th>
                            <th>项目编号</th>
                            <th>项目类型</th>
                            <th width="100">操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ms-for="($index,el) in @projectList">
                            <td>{{$index+1}}</td>
                            <td class="text-left">{{el.项目名称}}</td>
                            <td>{{el.项目编号}}</td>
                            <td>{{el.项目类型名称}}</td>
                            <td class="operation">
                                <ul>
                                    <li class="bs-tooltip btn-del" data-toggle="tooltip" data-placement="bottom"
                                        title="删除">
                                        <a href="javascript:;" ms-on-click="@projectList.remove(el)">
                                            <i class="icon iconfont icon-shanchu1"></i>
                                        </a>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div ms-if="@projectList.length==0||@projectList==null">
                    <p class="text-center"><img src="/IMIS/images/nothing-3.png"></p>
                </div>
            </div>
            <div role="tabpanel" id="tab3" class="tab-pane">
                <div class="title-box">
                    <a ms-attr="{'href':@getUrl('../论文/选择作者.html')}" class="btn btn-primary btn-add" data-toggle="modal"
                       data-target=".modal-choice" onclick="changeUrlChoice(this,'.modal-choice')">
                        <i class="icon iconfont icon-tianjia"></i> 添加作者
                    </a>
                    <span class="text-right remarks">说明：一个作者级别只能一人选择，不能多人同时选择。</span>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th width="80">序号</th>
                            <th>作者姓名</th>
                            <th>所属部门</th>
                            <th>作者级别</th>
                            <th>工作量占比（%）</th>
                            <th>完成字数（万字）</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ms-for="($index,el) in @info.作者">
                            <td>{{$index+1}}</td>
                            <td ms-attr>{{el.姓名}}</td>
                            <td>{{el.部门名称}}</td>
                            <td>
                                <select class="form-control level" ms-duplex="@el.作者级别">
                                    <option value="">请选择</option>
                                    <option ms-attr="{'value':@al}" ms-for="al in @model.著作作者级别">{{al}}</option>
                                </select>
                            </td>
                            <td>
                                <input type="text" class="text-center form-control" ms-duplex="@el.工作量占比"
                                       ms-on-keyup="value=value.replace(/[^\d]/g,'')"/>
                            </td>
                            <td>
                                <input type="text" class="text-center number form-control" ms-duplex="@el.完成字数"
                                       ms-on-keyup="value=value.replace(/[^\d]/g,'')"/>
                            </td>
                            <td class="operation">
                                <ul>
                                    <li class="bs-tooltip btn-del" data-toggle="tooltip" data-placement="bottom"
                                        title="删除">
                                        <a href="javascript:;" ms-on-click="@info.作者.remove(el)">
                                            <i class="icon iconfont icon-shanchu1"></i>
                                        </a>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div ms-if="@info.作者.length==0||@info.作者==null">
                    <p class="text-center"><img src="/IMIS/images/nothing-3.png"></p>
                </div>
            </div>
            <div role="tabpanel" id="tab4" class="tab-pane">
                <form class="form-horizontal content">
                    <div class="col-sm-12 fileUpload-box fileUpload-cover">
                        <h5 class="title"><span>封面相关文件</span></h5>
                        <div class="form-group  col-sm-6">
                            <label class="col-md-4 col-sm-4 control-label" for="input-file">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>上传封面：
                            </label>
                            <div class="col-md-7 col-sm-7 file-box">
                                <input type="file" id="input-file" class="input-file" name="fileUpload"
                                       onclick="fileChange(this,'.fileUpload-cover .input-file')">
                                <div class="file">
                                    <a class="file-text btn btn-default" href="javascript:;">选择文件</a>
                                    <span class="file-name"></span>
                                </div>
                                <a class="btn btn-primary" href="javascript:;"
                                   ms-on-click="@clickUploadCover($event)">上传</a>
                                <div class="loading">文件上传中...</div>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6" ms-if="@coverFiles.length>0">
                            <label class="col-md-3 col-sm-3 control-label">已上传：</label>
                            <div class="col-md-8 col-sm-8 items">
                                <div class="item" ms-for="el in @coverFiles">
                                    <a class="name" ms-attr="{'href':@el}" download="">{{@getHtmlDocName(el)}}</a>
                                    <a class="btn-del" href="javascript:;" ms-on-click="@coverFiles.remove(el)">
                                        <i class="icon iconfont icon-shanchu1"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 fileUpload-box fileUpload-copyright">
                        <h5 class="title"><span>版权页相关文件</span></h5>
                        <div class="form-group  col-sm-6">
                            <label class="col-md-4 col-sm-4 control-label" for="input-file2">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>上传版权页：
                            </label>
                            <div class="col-md-7 col-sm-7 file-box">
                                <input type="file" id="input-file2" class="input-file" name="fileUpload"
                                       onclick="fileChange(this,'.fileUpload-copyright .input-file')">
                                <div class="file">
                                    <a class="file-text btn btn-default" href="javascript:;">选择文件</a>
                                    <span class="file-name"></span>
                                </div>
                                <a class="btn btn-primary" href="javascript:;" ms-on-click="@clickUploadCopyright">上传</a>
                                <div class="loading">文件上传中...</div>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6" ms-if="@copyrightFiles.length>0">
                            <label class="col-md-3 col-sm-3 control-label">已上传：</label>
                            <div class="col-md-8 col-sm-8 items">
                                <div class="item" ms-for="el in @copyrightFiles">
                                    <a class="name" ms-attr="{'href':@el}" download="">{{@getHtmlDocName(el)}}</a>
                                    <a class="btn-del" href="javascript:;" ms-on-click="@copyrightFiles.remove(el)">
                                        <i class="icon iconfont icon-shanchu1"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 fileUpload-box fileUpload-preface">
                        <h5 class="title"><span>前言页相关文件</span></h5>
                        <div class="form-group  col-sm-6">
                            <label class="col-md-4 col-sm-4 control-label" for="input-file2">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>上传前言页：
                            </label>
                            <div class="col-md-7 col-sm-7 file-box">
                                <input type="file" id="input-file3" class="input-file" name="fileUpload"
                                       onclick="fileChange(this,'.fileUpload-preface .input-file')">
                                <div class="file">
                                    <a class="file-text btn btn-default" href="javascript:;">选择文件</a>
                                    <span class="file-name"></span>
                                </div>
                                <a class="btn btn-primary" href="javascript:;" ms-on-click="@clickUploadPreface">上传</a>
                                <div class="loading">文件上传中...</div>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6" ms-if="@prefaceFiles.length>0">
                            <label class="col-md-3 col-sm-3 control-label">已上传：</label>
                            <div class="col-md-8 col-sm-8 items">
                                <div class="item" ms-for="el in @prefaceFiles">
                                    <a class="name" ms-attr="{'href':@el}" download="">{{@getHtmlDocName(el)}}</a>
                                    <a class="btn-del" href="javascript:;" ms-on-click="@prefaceFiles.remove(el)">
                                        <i class="icon iconfont icon-shanchu1"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 fileUpload-box fileUpload-catalog">
                        <h5 class="title"><span>完整目录页相关文件</span></h5>
                        <div class="form-group  col-sm-6">
                            <label class="col-md-4 col-sm-4 control-label" for="input-file2">
                                <i class="icon iconfont icon-text-sign icon-sign"></i>上传完整目录：
                            </label>
                            <div class="col-md-7 col-sm-7 file-box">
                                <input type="file" id="input-file4" class="input-file" name="fileUpload"
                                       onclick="fileChange(this,'.fileUpload-catalog .input-file')">
                                <div class="file">
                                    <a class="file-text btn btn-default" href="javascript:;">选择文件</a>
                                    <span class="file-name"></span>
                                </div>
                                <a class="btn btn-primary" href="javascript:;" ms-on-click="@clickUploadCatalog">上传</a>
                                <div class="loading">文件上传中...</div>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6" ms-if="@catalogFiles.length>0">
                            <label class="col-md-3 col-sm-3 control-label">已上传：</label>
                            <div class="col-md-8 col-sm-8 items">
                                <div class="item" ms-for="el in @catalogFiles">
                                    <a class="name" ms-attr="{'href':@el}" download="">{{@getHtmlDocName(el)}}</a>
                                    <a class="btn-del" href="javascript:;" ms-on-click="@catalogFiles.remove(el)">
                                        <i class="icon iconfont icon-shanchu1"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 fileUpload-box fileUpload-other">
                        <h5 class="title"><span>其他相关文件</span></h5>
                        <div class="form-group  col-sm-6">
                            <label class="col-md-4 col-sm-4 control-label" for="input-file3">上传相关文件：</label>
                            <div class="col-md-7 col-sm-7 file-box">
                                <input type="file" id="input-file5" class="input-file" name="fileUpload"
                                       onclick="fileChange(this,'.fileUpload-other .input-file')">
                                <div class="file">
                                    <a class="file-text btn btn-default" href="javascript:;">选择文件</a>
                                    <span class="file-name"></span>
                                </div>
                                <a class="btn btn-primary" href="javascript:;" ms-on-click="@clickUploadOther">上传</a>
                                <div class="loading">文件上传中...</div>
                            </div>
                        </div>
                        <div class="form-group  col-sm-6" ms-if="@otherFiles.length>0">
                            <label class="col-md-3 col-sm-3 control-label">已上传：</label>
                            <div class="col-md-8 col-sm-8 items">
                                <div class="item" ms-for="el in @otherFiles">
                                    <a class="name" ms-attr="{'href':@el}" download="">{{@getHtmlDocName(el)}}</a>
                                    <a class="btn-del" href="javascript:;" ms-on-click="@otherFiles.remove(el)">
                                        <i class="icon iconfont icon-shanchu1"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div role="tabpanel" id="tab5" class="tab-pane">
                <h4 class="text-center auditing-title">审核记录</h4>
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th width="80">序号</th>
                            <th>步骤名称</th>
                            <th>处理人</th>
                            <th>状态</th>
                            <th>执行时间</th>
                            <th>备注</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ms-for="($index,el) in @shenHe">
                            <td>{{$index+1}}</td>
                            <td>{{el.名称}}</td>
                            <td>{{el.姓名}}</td>
                            <td ms-class="getClass(el.状态说明)">{{el.状态说明}}</td>
                            <td>{{el.执行时间}}</td>
                            <td>{{el.备注}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div ms-if="@shenHe.length==0||@shenHe==null">
                    <p class="text-center"><img src="/IMIS/images/nothing-3.png"></p>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer submit-wrapper">
        <div class="form-group">
            <div class="submit-box text-center">
                <button type="button" class="btn btn-primary btn-submit" ms-on-click="@clickSubmit">提交</button>
                <button type="button" class="btn btn-success btn-submit" ms-on-click="@temporary">暂存</button>
                <button type="button" class="btn btn-default" data-dismiss="modal" ms-on-click="@clickBtnReturn">取消
                </button>
                <div class="tip-box"></div>
            </div>
        </div>
    </div>
</div>
