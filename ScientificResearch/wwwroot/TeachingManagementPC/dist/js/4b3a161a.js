(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6caa"],{"5igj":function(t,e,n){"use strict";var i=n("Y+W0");n.n(i).a},F41P:function(t,e,n){"use strict";var i=n("U5l7");n.n(i).a},Rozo:function(t,e,n){"use strict";var i=n("nLBs");n.n(i).a},U5l7:function(t,e,n){},"Y+W0":function(t,e,n){},jQvD:function(t,e,n){"use strict";n.r(e);var i=n("cLjf"),s=n.n(i),r=n("hDQ3"),a=n.n(r),o=n("YHGi"),l=n("K3Y6"),c={name:"",props:["selectArr"],data:function(){return{req:{Index:1,Size:10,OrderType:!1,"Like学员类型名称":"","是否启用":"","Like姓名":""},students:[],newSelectStudents:[],total:0,loading:!1,index:"",item:{}}},mounted:function(){this.newSelectStudents=this.selectArr,this.getStudents()},methods:{getStudents:function(){var t=a()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$http.myGet(o.i.GET_PAGING_ALL_STUDENT,this.req);case 2:(e=t.sent)&&e.list.length>0?(this.students=e.list,this.total=e.total):this.students=[],this.loading=!1;case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),remoteMethod:function(t){""!==t?(this.loading=!0,this.req.Like姓名=t,this.getStudents()):(this.req.Like姓名="",this.getStudents())},clickLi:function(t,e){this.index=t,this.item=e,this.$emit("myEvent",e)},onSearch:function(){this.req.Index=1,this.getStudents()},changeSelect:function(t){this.$emit("myEvent",t)},handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){this.req.Index=t,this.getStudents()}}},u=(n("Rozo"),n("ZrdR")),d=Object(u.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"rotation-box"},[n("i",{staticClass:"iconfont iconshouqi"}),t._v(" "),n("span",{staticClass:"background"}),t._v(" "),n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入学员姓名","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.onSearch(e):null}},model:{value:t.req.Like姓名,callback:function(e){t.$set(t.req,"Like姓名",e)},expression:"req.Like姓名"}})],1),t._v(" "),n("ul",t._l(t.students,function(e,i){return n("li",{key:e.编号,on:{click:function(n){t.clickLi(i,e)}}},[n("a",{attrs:{href:"javascript:;"}},[n("span",{staticClass:"name"},[t._v(t._s(e.姓名)+"\n          "),e.专业名称?n("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v(t._s(e.专业名称))]):t._e()],1),t._v(" "),n("span",{staticClass:"type"},[n("el-tag",{attrs:{size:"mini"}},[t._v(t._s(e.学员类型名称))])],1)])])})),t._v(" "),n("div",{staticClass:"block paging"},[n("el-pagination",{attrs:{"current-page":t.req.Index,"page-size":t.req.Size,background:"",layout:"total, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.req,"Index",e)}}})],1)])},[],!1,null,"060db8e5",null);d.options.__file="selectStudent.vue";var f=d.exports,h={name:"selectRoleUser",props:["number","roleId"],data:function(){return{req:{Index:1,Size:10,OrderType:!1,"部门编号":"","教学角色编号":"",LikeAllName:""},users:[],total:0,id:"",index:""}},mounted:function(){this.id=this.number,this.req.教学角色编号=this.roleId,this.getUser()},methods:{getUser:function(){var t=a()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$http.myGet(o.j.GET_PAGING_ROLE_USERS,this.req);case 2:e=t.sent,console.info(e),e&&e.list.length>0?(this.users=e.list,this.total=e.total):this.users=[];case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onSearch:function(){this.req.Index=1,this.getUser()},clickLi:function(t){this.$emit("myEvent",t)},changeSelect:function(t){this.$emit("myEvent",t)},handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){this.req.Index=t,this.getUser()}}},p=(n("uMhO"),Object(u.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"rotation-box"},[n("i",{staticClass:"iconfont iconshouqi"}),t._v(" "),n("span",{staticClass:"background"}),t._v(" "),n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入姓名或部门","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.onSearch(e):null}},model:{value:t.req.LikeAllName,callback:function(e){t.$set(t.req,"LikeAllName",e)},expression:"req.LikeAllName"}})],1),t._v(" "),n("ul",t._l(t.users,function(e){return n("li",{key:e.编号,on:{click:function(n){t.clickLi(e)}}},[n("a",{attrs:{href:"javascript:;"}},[n("span",{staticClass:"name"},[t._v(t._s(e.姓名))]),t._v(" "),n("span",{staticClass:"type"},[e.部门名称?n("el-tag",{attrs:{size:"mini"}},[t._v(t._s(e.部门名称))]):t._e()],1)])])})),t._v(" "),n("div",{staticClass:"block paging"},[n("el-pagination",{attrs:{"current-page":t.req.Index,"page-size":t.req.Size,background:"",layout:"total,prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.req,"Index",e)}}})],1)])},[],!1,null,"624d5129",null));p.options.__file="selectRoleUser.vue";var m={name:"addEvaluation360",components:{selectStudent:f,selectRoleUser:p.exports},data:function(){return{form:{Model:{"编号":0,"来源类型":0,"评价人编号":0,"评价人姓名":"","目标类型":0,"被评价人编号":0,"被评价人姓名":"","评价内容":"","评价时间":Object(l.h)(new Date,"yyyy-MM-dd"),"备注":""},List:[]},rules:{"评价人编号":[{required:!0,message:"请选择评价人！",trigger:"blur"}],"被评价人编号":[{required:!0,message:"请选择被评价人！",trigger:"blur"}]},reqUer:{},list:[],isDialog:!1,isAdd:!0,isLoad:!1,isShow:!1,direction:"",projects:[],scorings:[],directives:{clickoutside:l.e},defaultVal:5,getRowKeys:function(t){return t.分类信息.编号}}},directives:{clickoutside:l.e},mounted:function(){if(sessionStorage.getItem("itemData")){var t=JSON.parse(sessionStorage.getItem("itemData"));if(this.direction=t.direction,console.info(t),this.isAdd=t.isAdd,this.isAdd){if(this.$route.meta.title="添加评价",localStorage.getItem("userInfo")){var e=JSON.parse(localStorage.getItem("userInfo")).人员;this.form.Model.评价人编号=e.编号,this.form.Model.评价人姓名=e.姓名,this.form.Model.来源类型=t.来源类型,this.form.Model.目标类型=t.目标类型}this.isLoad=!0}else this.$route.meta.title="修改评价",this.form.Model=t.item,this.getEvaluationScoring(t.item.编号);this.getTypeAndProject(t.目标类型)}},methods:{getTypeAndProject:function(){var t=a()(s.a.mark(function t(e){var n,i,r=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={"目标类型":e},t.next=3,this.$http.myGet(o.k.GET_360_EVALUATE_CLASSIFY_AND_PROJECT,n);case 3:(i=t.sent)&&i.length>0&&(this.isAdd||i.forEach(function(t){t.分类下的项目.length>0&&t.分类下的项目.forEach(function(t){r.scorings.find(function(e){t.编号==e.教学360评价项目编号&&(t.实际得分=e.评分,t.rete=Math.round(t.实际得分/t.标准分*r.defaultVal))})})}),this.projects=i);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),changeRate:function(t,e){e.实际得分=Math.round(e.标准分/this.defaultVal*t)},getEvaluationScoring:function(){var t=a()(s.a.mark(function t(e){var n,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={"教学360评价编号":e},t.next=3,this.$http.myGet(o.d.GET_EVALUATE_SCORE,n);case 3:(i=t.sent)&&i.length>0&&(this.scorings=i,this.isLoad=!0);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleClose:function(t){this.isShow=!1},getNewList:function(){var t=[];this.projects.forEach(function(e){e.分类下的项目.length>0&&e.分类下的项目.forEach(function(e){if(e.实际得分&&e.实际得分>0){var n={"编号":0,"教学360评价项目编号":e.编号,"评分":e.实际得分};t.push(n)}})}),this.form.List=t},confirmHandler:Object(l.a)(function(){var t=this;this.$refs.form.validate(function(e){return e?(t.getNewList(),t.form.List&&0!=t.form.List.length?void t.addEdit360Evaluation(t.form):(t.$message.error("请给评价项目打分！"),!1)):(t.$message.error("信息有误！"),!1)})},300),addEdit360Evaluation:function(){var t=a()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$http.myPost(o.d.POST_ADD_EDIT_360EVALUATE,e);case 2:this.$message.success("提交成功！"),this.$router.go(-1);case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),myEventUser:function(t){this.form.Model.被评价人姓名=t.姓名,this.form.Model.被评价人编号=t.编号,this.isShow=!1}}},v=(n("F41P"),n("5igj"),Object(u.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container page-common page-addStudent page-addEvaluate"},[n("div",{staticClass:"btn-back-box"},[n("el-button",{staticClass:"btn-back",attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.$router.go(-1)}}},[n("i",{staticClass:"iconfont iconfanhui"}),t._v(" 返回\n    ")])],1),t._v(" "),n("h5",{staticClass:"title"},[t._v(t._s(t.direction.名称))]),t._v(" "),t.isLoad?n("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:t.form,rules:t.rules,"label-width":"150px",size:"small"}},[n("el-form-item",{attrs:{label:"评价方向"}},[n("el-input",{attrs:{disabled:""},model:{value:t.direction.名称,callback:function(e){t.$set(t.direction,"名称",e)},expression:"direction.名称"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"评价人",prop:"Model.评价人姓名"}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.Model.评价人姓名,callback:function(e){t.$set(t.form.Model,"评价人姓名",e)},expression:"form.Model.评价人姓名"}})],1),t._v(" "),n("el-form-item",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClose,expression:"handleClose"}],attrs:{label:"被评价人",prop:"Model.被评价人姓名"}},[n("el-input",{on:{focus:function(e){t.isShow=!0}},model:{value:t.form.Model.被评价人姓名,callback:function(e){t.$set(t.form.Model,"被评价人姓名",e)},expression:"form.Model.被评价人姓名"}}),t._v(" "),t.isShow?n("div",[0==t.form.Model.目标类型?n("selectStudent",{on:{myEvent:t.myEventUser}}):n("selectRoleUser",{attrs:{roleId:t.form.Model.目标类型},on:{myEvent:t.myEventUser}})],1):t._e()],1),t._v(" "),n("el-form-item",{attrs:{label:"被评价人类型"}},[n("el-input",{attrs:{disabled:""},model:{value:t.direction.被评价人类型,callback:function(e){t.$set(t.direction,"被评价人类型",e)},expression:"direction.被评价人类型"}})],1),t._v(" "),n("el-form-item",{staticClass:"el-form-item-block",attrs:{label:"评价内容",prop:"Model.评价内容"}},[n("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea"},model:{value:t.form.Model.评价内容,callback:function(e){t.$set(t.form.Model,"评价内容",e)},expression:"form.Model.评价内容"}})],1)],1):t._e(),t._v(" "),n("div",{staticClass:"content"},[n("h5",{staticClass:"title"},[t._v("评价项目打分：")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.projects,"default-expand-all":"","row-key":t.getRowKeys}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.row.分类下的项目,border:""}},[n("el-table-column",{attrs:{label:"序号",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"名称",prop:"名称"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"标准分",prop:"标准分",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"实际得分",prop:"实际得分"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-rate",{attrs:{max:t.defaultVal,"show-text":""},on:{change:function(n){t.changeRate(e.row.rete,e.row)}},model:{value:e.row.rete,callback:function(n){t.$set(e.row,"rete",n)},expression:"scopeChild.row.rete"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"说明",prop:"备注"}})],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"评价项目",prop:"分类信息.名称",align:"left"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer footer-box",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmHandler}},[t._v("确 定")])],1)],1)},[],!1,null,"5666125c",null));v.options.__file="addEvaluate.vue";e.default=v.exports},nLBs:function(t,e,n){},ogWu:function(t,e,n){},uMhO:function(t,e,n){"use strict";var i=n("ogWu");n.n(i).a}}]);