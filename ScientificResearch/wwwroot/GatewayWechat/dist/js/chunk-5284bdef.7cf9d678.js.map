{"version":3,"sources":["webpack:///./src/views/login.vue?ff30","webpack:///./src/assets/js/common/debounce.js","webpack:///./src/assets/images/iocn/logo.png","webpack:///./src/views/login.vue?b553","webpack:///src/views/login.vue","webpack:///./src/views/login.vue?eef6","webpack:///./src/views/login.vue"],"names":["_debounce","fn","delay","timer","th","this","args","arguments","clearTimeout","setTimeout","apply","module","exports","render","_vm","_h","$createElement","_c","_self","staticClass","Logo","attrs","url","defaultImg","directives","name","rawName","value","expression","domProps","on","$event","target","composing","DbKey","max","min","工号","密码","bind","_v","staticRenderFns","data","code","HospitalInformationL","created","getUrlKey","getLogo","mounted","console","log","$route","localStorage","getItem","removeItem","$http","LoginWithOpenId","then","res","error","personnel","JSON","stringify","人员","token","HospitalInformation","flag","$router","push","methods","$notify","BindOpenId","component"],"mappings":"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","file":"js/chunk-5284bdef.7cf9d678.js","sourcesContent":["import mod from \"-!../../node_modules/_mini-css-extract-plugin@0.6.0@mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/_css-loader@1.0.1@css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=style&index=0&id=d9997e02&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/_mini-css-extract-plugin@0.6.0@mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/_css-loader@1.0.1@css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=style&index=0&id=d9997e02&scoped=true&lang=css&\"","/**\r\n * 函数防抖 (只执行最后一次点击)\r\n * @param fn\r\n * @param delay\r\n * @returns {Function}\r\n * @constructor\r\n */\r\nexport function _debounce(fn, delay) {\r\n    var delay = delay || 200;\r\n    var timer;\r\n    return function() {\r\n        var th = this;\r\n        var args = arguments;\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        timer = setTimeout(function() {\r\n            timer = null;\r\n            fn.apply(th, args);\r\n        }, delay);\r\n    };\r\n}","module.exports = __webpack_public_path__ + \"img/logo.af96feb7.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"box\"},[_c('div',{staticClass:\"nav\"},[(this.Logo!=null)?_c('img',{attrs:{\"src\":_vm.url+this.Logo}}):_c('img',{attrs:{\"src\":this.defaultImg}})]),_c('form',{attrs:{\"action\":\"/\",\"onsubmit\":\"return false\"}},[_c('div',{staticClass:\"input\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.DbKey),expression:\"DbKey\"}],attrs:{\"type\":\"text\",\"placeholder\":\"医院\"},domProps:{\"value\":(_vm.DbKey)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.DbKey=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.工号),expression:\"工号\"}],attrs:{\"type\":\"text\",\"placeholder\":\"工号\",\"maxlength\":_vm.max,\"minlength\":_vm.min,\"prop\":\"工号\"},domProps:{\"value\":(_vm.工号)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.工号=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.密码),expression:\"密码\"}],attrs:{\"type\":\"password\",\"placeholder\":\"密码\",\"maxlength\":_vm.max,\"minlength\":_vm.min,\"prop\":\"密码\"},domProps:{\"value\":(_vm.密码)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.密码=$event.target.value}}})]),_c('div',{staticClass:\"btn\",on:{\"click\":_vm.bind}},[_c('span',[_vm._v(\"登 录\")])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <section class=\"box\">\r\n    <div class=\"nav\">\r\n      <!-- <img src=\"@/assets/images/iocn/logo.png\" alt=\"logo图片\" class=\"img\"> -->\r\n      <!-- <img :src=\"this.Logo || this.defaultImg\" class=\"img\"> -->\r\n      <img v-if=\"this.Logo!=null\" :src=\"url+this.Logo\" />\r\n      <img v-else :src=\"this.defaultImg\" />\r\n    </div>\r\n    <form action=\"/\" onsubmit=\"return false\">\r\n      <div class=\"input\">\r\n        <input type=\"text\" placeholder=\"医院\" v-model=\"DbKey\" />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"工号\"\r\n          v-model=\"工号\"\r\n          :maxlength=\"max\"\r\n          :minlength=\"min\"\r\n          prop=\"工号\"\r\n        />\r\n        <input\r\n          type=\"password\"\r\n          placeholder=\"密码\"\r\n          v-model=\"密码\"\r\n          :maxlength=\"max\"\r\n          :minlength=\"min\"\r\n          prop=\"密码\"\r\n        />\r\n      </div>\r\n      <div class=\"btn\" @click=\"bind\">\r\n        <span>登 录</span>\r\n      </div>\r\n    </form>\r\n    <!-- <van-popup v-model=\"show\" position=\"bottom\" overlay close-on-click-overlay>\r\n      <van-picker\r\n        show-toolbar\r\n        title=\"医院列表\"\r\n        :columns=\"columns\"\r\n        @cancel=\"onCancel\"\r\n        @confirm=\"onConfirm\"\r\n      />\r\n    </van-popup>-->\r\n  </section>\r\n</template>\r\n<script>\r\nimport { _debounce } from \"@/assets/js/common/debounce.js\";\r\nexport default {\r\n  name: \"login\",\r\n  data() {\r\n    return {\r\n      code: \"\",\r\n      max: 20,\r\n      min: 3,\r\n      工号: null,\r\n      密码: null,\r\n      DbKey: null,\r\n      Logo: null,\r\n      url:\r\n        process.env.NODE_ENV === \"development\"\r\n          ? \"http://192.168.3.3:63739\"\r\n          : \"\",\r\n      HospitalInformationL: \"\",\r\n      defaultImg: require(\"@/assets/images/iocn/logo.png\")\r\n      // columns: [],\r\n      // show: false\r\n    };\r\n  },\r\n  created() {\r\n    this.DbKey = this.getUrlKey(\"name\");\r\n    this.getLogo();\r\n  },\r\n  mounted() {\r\n    this.code = this.getUrlKey(\"code\");\r\n    console.log(this.$route);\r\n    if (this.code) {\r\n      if (!localStorage.getItem(\"reset\")) {\r\n        // this.handleLoginByCode(this.code).then(res => {\r\n        //   if (!res.error) {\r\n        //     this.$router.push({\r\n        //       name: this.$config.homeName\r\n        //     });\r\n        //   }\r\n        // });\r\n        this.$http.LoginWithOpenId(this.code).then(res => {\r\n          if (!res.error) {\r\n            localStorage.personnel = JSON.stringify(res.data.人员);\r\n            localStorage.token = `${res.data.token_type} ${res.data.access_token}`;\r\n            this.HospitalInformation = this.DbKey;\r\n            this.getLogo();\r\n            localStorage.HospitalInformation = JSON.stringify(\r\n              this.HospitalInformation\r\n            );\r\n            localStorage.flag = false;\r\n            this.$router.push(\"/\");\r\n          }\r\n        });\r\n      } else {\r\n        localStorage.removeItem(\"reset\");\r\n      }\r\n    } else {\r\n      this.$router.push(\"/guidance\");\r\n      //console.log(this.$route);\r\n    }\r\n  },\r\n  methods: {\r\n    getUrlKey(name) {\r\n      //获取url 参数\r\n      return (\r\n        decodeURIComponent(\r\n          (new RegExp(\"[?|&]\" + name + \"=\" + \"([^&;]+?)(&|#|;|$)\").exec(\r\n            location.href\r\n          ) || [, \"\"])[1].replace(/\\+/g, \"%20\")\r\n        ) || null\r\n      );\r\n    },\r\n    getLogo: async function() {\r\n      let para = {\r\n        k: this.DbKey\r\n      };\r\n      let res = await this.$http.getHospitalInformation(para);\r\n      this.Logo = res.data.Logo;\r\n      this.HospitalInformation = res.data;\r\n    },\r\n    // 登录 防抖\r\n    bind: _debounce(function() {\r\n      if (this.工号 === null || this.密码 === null || this.DbKey === null) {\r\n        this.$notify(\"医院 工号 密码 不能为空！\");\r\n        return;\r\n      } else if (this.工号.length < 4) {\r\n        this.$notify(\"工号长度不能少于【4】位\");\r\n        return;\r\n      } else if (this.密码 == null) {\r\n        this.$notify(\"密码长度不能少于【3】位\");\r\n        return;\r\n      } else if (this.密码.length < 3) {\r\n        this.$notify(\"密码长度不能少于【3】位\");\r\n        return;\r\n      } else {\r\n        var code = this.getUrlKey(\"code\");\r\n        this.HospitalInformation = this.DbKey;\r\n        this.getLogo();\r\n        if (code) {\r\n          let DbKey =\r\n            this.DbKey == \"演示医院\" ? \"ScientificResearch_Test\" : this.DbKey;\r\n          this.$http.BindOpenId(code, this.工号, this.密码, DbKey).then(res => {\r\n            if (!res.error) {\r\n              // 登录成功 储存 token\r\n              localStorage.personnel = JSON.stringify(res.data.人员);\r\n              localStorage.token = `${res.data.token_type} ${res.data.access_token}`;\r\n\r\n              this.$router.push(\"/\");\r\n              localStorage.HospitalInformation = JSON.stringify(\r\n                this.HospitalInformation\r\n              );\r\n\r\n              localStorage.flag = false;\r\n            } else {\r\n              this.$notify(\"登录信息有误！\");\r\n            }\r\n          });\r\n        } else {\r\n          this.$notify(\"请授权后再登录！\");\r\n        }\r\n      }\r\n    }, 500)\r\n\r\n    // 显示医院列表\r\n    // hospital() {\r\n    //   this.show = true;\r\n    // },\r\n    // onConfirm(value, index) {\r\n    //   this.DbKey = value;\r\n    //   this.show = false;\r\n    // },\r\n    // onCancel() {\r\n    //   this.show = false;\r\n    // }\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.box {\r\n  height: 100vh;\r\n  /* padding-bottom: 50px; */\r\n  background-color: #fff;\r\n}\r\n.nav img {\r\n  width: 250px;\r\n  height: 60px;\r\n  margin: 50px 0 20px 0;\r\n}\r\n\r\n.input > input {\r\n  display: block;\r\n  margin: 0 auto;\r\n  /* padding: 10px 5px; */\r\n  line-height: 2;\r\n  margin-top: 5px;\r\n  border: none;\r\n  border-bottom: 1px solid #57d4ce;\r\n  width: 250px;\r\n  outline-style: none;\r\n  font-size: 14px;\r\n}\r\n.btn {\r\n  margin: auto;\r\n  margin-top: 30px;\r\n  padding: 8px 5px;\r\n  border-radius: 20px;\r\n  background-color: #57d4ce;\r\n  color: #fff;\r\n  width: 260px;\r\n  font-size: 16px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=d9997e02&scoped=true&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&id=d9997e02&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.7.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d9997e02\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}